<!-- app/views/products/create.turbo_stream.erb -->
<% container_id = "products_#{@product.purchase_date.strftime('%Y-%m-%d')}" %>
<% existing_container = @products.key?(@product.purchase_date) %>

<% if !@product.purchased && existing_container %>
  <%= turbo_stream.replace container_id do %>
    <div id="<%= container_id %>" class="group-of-products">
      <h3><%= l(@product.purchase_date, format: :default) %></h3>
      <%= render GroupOfProductsComponent.new(products: @products[@product.purchase_date] << @product) %>
    </div>
  <% end %>
<% elsif !@product.purchased %>
  <%= turbo_stream.append "products-container" do %>
    <div id="<%= container_id %>" class="group-of-products">
      <h3><%= l(@product.purchase_date, format: :default) %></h3>
      <%= render GroupOfProductsComponent.new(products: [@product]) %>
    </div>
  <% end %>
<% end %>






